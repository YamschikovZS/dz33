# Отчет к домашнему заданию №3 "Создание консольного калькулятора"

## Краткое описание

Разработана программа для вычисления математических выражений с использованием алгоритма преобразования в обратную польскую нотацию (RPN). Решение поддерживает базовые операции, математические функции,константы и переменные.

## Задачи работы
- Реализовать лексический анализатор для разбора математических выражений на отдельные составляющие (токены)
- Разработать алгоритм преобразования инфиксной записи в постфиксную
- Реализовать алгоритм для вычисления значения выражения в постфиксной нотации
- Реализовать корректную обработку всех компонентов арифметического выражений (чисел, констант, переменных, операторов, функций, скобок)

## Теоретические основы

В основе программы лежит алгоритм сортировочной станции для преобразования инфиксной записи выражений в постфиксную (RPN). Данный подход устраняет необходимость в скобках для определения приоритета операций и позволяет реализовать вычисления с использованием стека.

## Ключевые компоненты:

- 1. Лексический анализатор – разбивает ввод на токены (числа, операторы, функции, скобки)
- 2. Препроцессор – определяет унарные минусы и обрабатывает специальные символы
- 3. Конвертер в RPN – преобразует выражение в постфиксную форму
- 4. Вычислитель – интерпретирует постфиксную запись с использованием стека
- 5. Интерфейс – обеспечивает взаимодействие с пользователем
 
## Поддерживаемые элементы:

- Операции: +, -, *, /
- Функции: sin, cos, tg, ctg, exp
- Константы: PI, E
- Переменная: X
- Скобки и унарный минус

## Принцип работы

- 1. Получение математического выражения от пользователя
- 2. Токенизация входной строки с сохранением позиций элементов
- 3. Преобразование в RPN с учётом приоритетов операций
- 4. Запрос значения переменной X (при её наличии)
- 5. Вычисление результата путём обработки постфиксной записи

## Для наглядности продемонстрируем принцип работы программы с помощью блок-схемы ниже

```mermaid
flowchart TD
    Start([Начало]) --> Input[Ввод исходного выражения]
    
    Input --> Tokenization[Токенизация<br>Разбиение строки на элементарные части]
    
    Tokenization --> TokenProcessing[Обработка токенов<br>Идентификация типов]
    
    TokenProcessing --> XCheck{Выражение содержит x?}
    
    XCheck -- Да --> InputX[Запрос значения x от пользователя]
    XCheck -- Нет --> SetDefaultX[Автоматическая установка x = 0]
    
    InputX --> UnaryMinusProcessing
    SetDefaultX --> UnaryMinusProcessing
    
    UnaryMinusProcessing[Обработка унарного минуса<br>Преобразование унарных операций]
    
    UnaryMinusProcessing --> RPNConversion
    
    subgraph RPNConversion [Алгоритм преобразования в Обратную Польскую Нотацию]
        direction TB
        Init[Инициализация структур данных] --> ProcessTokens{Обработаны все токены?}
        
        ProcessTokens -- Нет --> TokenType{Текущий тип токена?}
        
        TokenType -- Число/Константа/Переменная --> OutputQueue[Добавить в выходную очередь]
        TokenType -- Функция/Унарный минус --> PushFunction[Поместить в стек операторов]
        TokenType -- Открывающая скобка --> PushBracketOpen[Поместить скобку в стек]
        TokenType -- Закрывающая скобка --> ProcessBracketClose[Выталкивать из стека в выход<br>до открывающей скобки]
        TokenType -- Бинарный оператор --> ProcessOperator[Вытолкнуть операторы с >= приоритетом<br>затем добавить текущий в стек]
        
        OutputQueue --> ProcessTokens
        PushFunction --> ProcessTokens
        PushBracketOpen --> ProcessTokens
        ProcessBracketClose --> ProcessTokens
        ProcessOperator --> ProcessTokens
        
        ProcessTokens -- Да --> Finalize[Вытолкнуть все оставшиеся<br>операторы из стека]
    end
    
    RPNConversion --> RPNCalculation[Вычисление значения выражения<br>по обратной польской нотации]
    
    RPNCalculation --> OutputResult[Вывод результата вычислений]
    
    OutputResult --> End([Конец])
```

## Заключение

Создано консольное приложение, способное корректно обрабатывать сложные математические выражения. Реализация демонстрирует эффективное применение алгоритмов обработки выражений, включая преобразование нотаций и стековые вычисления.
